<html>

<head>
  <title>Virus Detector</title>
</head>

<body>
  <div class="header">
    <div class="logo">
      <a href="/">
        <img style="mix-blend-mode: multiply;"  height="150" src="https://cdn.discordapp.com/attachments/842948869641338910/1103840986553126983/untitled_9.png"
        alt="logo">
      </a>
    </div>
  </div>

  <!-- UPLOAD -->
  <div class="upload-container">
    <label for="images" class="drop-container">
      <span class="drop-title">Drop file here</span>
      <div style="font-size:x-small; opacity: 80%">(jpg/png/webp)</div>
      or
      <input type="file" id="images" accept="image/*" required>
    </label>
  </div>

  <footer>
    <div class="description">
      <div class="item">
        <h4>APIs</h4>
        <ul>
          <li><a target="_blank" href="https://developers.google.com/identity/protocols/oauth2">Google OAuth 2.0</a></li>
          <li><a target="_blank" href="https://developers.google.com/drive/api/guides/about-sdk">Google Drive API</a></li>
          <li><a target="_blank" href="https://www.hybrid-analysis.com/docs/api/v2#/Quick%20Scan/post_quick_scan_file">Falcon Sandbox Public API</a></li>
        </ul>
      </div>
      <div class="item">
        <h4>Description</h4>
        <p>Virus Scanner will scan the file you provided for any malware using <a href="https://www.hybrid-analysis.com/docs/api/v2#/Quick%20Scan/post_quick_scan_file" target="_blank"> hybrid-analysis </a> API and upload it directly to your google drive.</p>
      </div>
    </div>
    <p>Author: Asadbek Karimov<br>
  </footer>
  
</body>

</html>

<script>

  /* on file upload invoke upload */
  const fileInput = document.getElementById('images');
  fileInput.addEventListener('change', uploadToServer);

  function uploadToServer() {
    const domain = 'https://asadbek064-crispy-journey-q7w64597966f959j.github.dev';
    const url = `${domain}/upload-file`;
    const file = fileInput.files[0];

    uploadFile(file, url, (err, res) => {
      if (err) console.log(err);

      console.log(res);
    })
  }

  function uploadFile(file, url, callback) {
    let xhr = new XMLHttpRequest();
    
    // check the status of our request 
    xhr.onreadystatechange = () =>{
      if (xhr.readyState === 4) { // request was sent
        if (xhr.status === 200) { // request was accepted
          callback(null, xhr.responseText); 
        } else {
          callback(xhr.status);
        }
      }
    };

    xhr.open('POST', url, true); // initiailize the request type POST, true for async flag
    const formData = FormData(); // create a new FormData object
    formData.append('file', file); // append our file to FormData with key = file
    xhr.send(formData); // send object to our server 
  }
</script>

<style>
a:link { text-decoration: none; }
a:visited { text-decoration: none; color: #084cdf; }
a:hover { text-decoration: none; }
a:active { text-decoration: none; }
  .description {
    text-align: start;
    padding-left: 1rem;
    display: flex;
    flex-direction: row;
  }

  .item {
    width: 24rem;
  }

  li {
    list-style-type: none;
    line-height: 1.6rem;
  }
  footer {
    opacity: 80%;
    text-align: center;
    padding: 3px;
    background-color: rgba(255, 255, 255, 0.5);
    color: #1e1e1e;
    flex-shrink: 0;
  }

  html, body {
    font-family: Tahoma, sans-serif;
    background: #6190E8;
    background: -webkit-linear-gradient(to right, #A7BFE8, #6190E8);
    /* Chrome 10-25, Safari 5.1-6 */
    background: linear-gradient(to right, #A7BFE8, #6190E8);
    /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    display: flex;
    flex-direction: column;

    height: 100%;

  }

  .logo {
    margin: 0 2.5rem;
  }

  .upload-container {
    display: flex;
    justify-content: center;
    margin: 2rem;
    padding: 2rem 4rem;
    flex: 1 0 auto;
  }

  .drop-container {
    position: relative;
    display: flex;
    gap: 10px;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 200px;
    padding: 20px;
    border-radius: 5px;
    color: #444;
    cursor: pointer;
    background-color: #ffff;
    box-shadow: rgba(17, 12, 46, 0.15) 0px 48px 100px 0px;
    transition: background 150ms ease-in-out, border 150ms ease-in-out;
  }

  .drop-container:hover {
    background: #f6f4f4;
    border-color: #111111;
  }


  .drop-container:hover .drop-title {
    color: #222;
  }

  .drop-title {
    color: #444;
    font-size: 2rem;
    font-weight: bold;
    text-align: center;
    transition: color 150ms ease-in-out;
  }

  input[type=file] {
    width: 350px;
    max-width: 100%;
    color: #444;
    padding: 5px;
    background: #fff;
    border-radius: 10px;
    border: 1px solid #393939cc;
  }

  input[type=file]::file-selector-button {
    margin-right: 20px;
    border: none;
    background: #084cdf;
    padding: 10px 20px;
    border-radius: 10px;
    color: #fff;
    cursor: pointer;
    transition: background 150ms ease-in-out;
  }

  input[type=file]::file-selector-button:hover {
    background: rgb(28, 23, 187);
  }

</style>